import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { motion, AnimatePresence } from 'framer-motion';
const priorityLabels = {
    1: { label: 'P1 - Critical', color: 'bg-red-100 text-red-700' },
    2: { label: 'P2 - High', color: 'bg-amber-100 text-amber-700' },
    3: { label: 'P3 - Medium', color: 'bg-blue-100 text-blue-700' },
    4: { label: 'P4 - Low', color: 'bg-slate-100 text-slate-600' },
};
const statusColors = {
    backlog: 'bg-slate-100 text-slate-700',
    todo: 'bg-slate-100 text-slate-700',
    in_progress: 'bg-blue-100 text-blue-700',
    review: 'bg-purple-100 text-purple-700',
    blocked: 'bg-red-100 text-red-700',
    done: 'bg-green-100 text-green-700',
    completed: 'bg-green-100 text-green-700',
};
const severityColors = {
    critical: 'bg-red-100 text-red-700',
    major: 'bg-orange-100 text-orange-700',
    minor: 'bg-yellow-100 text-yellow-700',
    trivial: 'bg-slate-100 text-slate-600',
};
const environmentColors = {
    production: 'bg-red-100 text-red-700',
    staging: 'bg-amber-100 text-amber-700',
    development: 'bg-blue-100 text-blue-700',
    local: 'bg-slate-100 text-slate-600',
};
const typeIcons = {
    epic: 'bolt',
    feature: 'category',
    task: 'task_alt',
    bug: 'bug_report',
};
export default function ItemDetailModal({ item, itemType, onClose }) {
    if (!item)
        return null;
    const priority = priorityLabels[item.priority || 3];
    const statusColor = statusColors[item.status || 'backlog'] || 'bg-slate-100 text-slate-700';
    return (_jsx(AnimatePresence, { children: _jsx("div", { className: "fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4", onClick: onClose, children: _jsxs(motion.div, { initial: { opacity: 0, scale: 0.95, y: 20 }, animate: { opacity: 1, scale: 1, y: 0 }, exit: { opacity: 0, scale: 0.95, y: 20 }, transition: { duration: 0.2 }, className: "w-full max-w-2xl max-h-[80vh] overflow-y-auto rounded-xl shadow-2xl", style: { backgroundColor: 'var(--bg-card)' }, onClick: (e) => e.stopPropagation(), children: [_jsxs("div", { className: "p-6 border-b", style: { borderColor: 'var(--border-primary)' }, children: [_jsxs("div", { className: "flex items-start justify-between gap-4", children: [_jsxs("div", { className: "flex items-start gap-3 flex-1", children: [_jsx("div", { className: "size-10 rounded-lg bg-gradient-to-br from-primary to-blue-600 flex items-center justify-center text-white shrink-0", children: _jsx("span", { className: "material-symbols-outlined", children: typeIcons[item.type || itemType] }) }), _jsxs("div", { className: "flex-1 min-w-0", children: [_jsx("div", { className: "flex items-center gap-2 mb-1", children: _jsxs("span", { className: "text-xs font-medium uppercase tracking-wide", style: { color: 'var(--text-muted)' }, children: [itemType, " #", item.id] }) }), _jsx("h2", { className: "text-xl font-bold", style: { color: 'var(--text-primary)' }, children: item.title })] })] }), _jsx("button", { onClick: onClose, className: "p-2 rounded-lg hover:bg-slate-100 transition-colors", style: { color: 'var(--text-muted)' }, children: _jsx("span", { className: "material-symbols-outlined", children: "close" }) })] }), _jsxs("div", { className: "flex flex-wrap items-center gap-2 mt-4", children: [_jsx("span", { className: `px-2.5 py-1 rounded-full text-xs font-semibold ${statusColor}`, children: (item.status || 'backlog').replace('_', ' ') }), priority && (_jsx("span", { className: `px-2.5 py-1 rounded-full text-xs font-semibold ${priority.color}`, children: priority.label })), item.type && itemType === 'task' && (_jsx("span", { className: `px-2.5 py-1 rounded-full text-xs font-semibold ${item.type === 'bug' ? 'bg-red-100 text-red-700' : 'bg-indigo-100 text-indigo-700'}`, children: item.type })), item.storyPoints && (_jsxs("span", { className: "px-2.5 py-1 rounded-full text-xs font-semibold bg-emerald-100 text-emerald-700", children: [item.storyPoints, " pts"] })), item.type === 'bug' && item.severity && (_jsx("span", { className: `px-2.5 py-1 rounded-full text-xs font-semibold ${severityColors[item.severity] || 'bg-slate-100 text-slate-600'}`, children: item.severity })), item.type === 'bug' && item.environment && (_jsx("span", { className: `px-2.5 py-1 rounded-full text-xs font-semibold ${environmentColors[item.environment] || 'bg-slate-100 text-slate-600'}`, children: item.environment })), item.labels && item.labels.length > 0 && item.labels.map((label) => (_jsx("span", { className: "px-2.5 py-1 rounded-full text-xs font-semibold bg-violet-100 text-violet-700", children: label }, label)))] })] }), item.status === 'blocked' && item.blockedReason && (_jsx("div", { className: "px-6 pt-4", children: _jsxs("div", { className: "p-4 rounded-lg bg-red-50 border border-red-200", children: [_jsxs("h3", { className: "text-sm font-semibold mb-2 flex items-center gap-2 text-red-700", children: [_jsx("span", { className: "material-symbols-outlined text-[18px]", children: "block" }), "Blocked"] }), _jsx("p", { className: "text-sm text-red-600", children: item.blockedReason })] }) })), _jsxs("div", { className: "p-6", children: [_jsxs("h3", { className: "text-sm font-semibold mb-3 flex items-center gap-2", style: { color: 'var(--text-secondary)' }, children: [_jsx("span", { className: "material-symbols-outlined text-[18px]", children: "description" }), "Description"] }), item.description ? (_jsx("div", { className: "prose prose-sm max-w-none p-4 rounded-lg", style: { backgroundColor: 'var(--bg-tertiary)', color: 'var(--text-primary)' }, children: _jsx("p", { className: "whitespace-pre-wrap m-0", children: item.description }) })) : (_jsx("p", { className: "text-sm italic", style: { color: 'var(--text-muted)' }, children: "No description provided" }))] }), (itemType === 'epic' || itemType === 'feature') && typeof item.progress === 'number' && (_jsxs("div", { className: "px-6 pb-4", children: [_jsxs("div", { className: "flex items-center justify-between mb-2", children: [_jsx("span", { className: "text-sm font-medium", style: { color: 'var(--text-secondary)' }, children: "Progress" }), _jsxs("span", { className: "text-sm font-bold", style: { color: 'var(--text-primary)' }, children: [item.progress, "%"] })] }), _jsx("div", { className: "w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2 overflow-hidden", children: _jsx("div", { className: "h-full bg-gradient-to-r from-primary to-blue-500 transition-all duration-500", style: { width: `${item.progress}%` } }) })] })), (itemType === 'epic' || itemType === 'feature') && (item.targetDate || item.startDate || item.resolution) && (_jsxs("div", { className: "px-6 pb-4", children: [_jsxs("h3", { className: "text-sm font-semibold mb-3 flex items-center gap-2", style: { color: 'var(--text-secondary)' }, children: [_jsx("span", { className: "material-symbols-outlined text-[18px]", children: "calendar_month" }), "Timeline"] }), _jsxs("div", { className: "grid grid-cols-2 gap-4 p-4 rounded-lg", style: { backgroundColor: 'var(--bg-tertiary)' }, children: [item.startDate && (_jsxs("div", { children: [_jsx("span", { className: "text-xs font-medium", style: { color: 'var(--text-muted)' }, children: "Start Date" }), _jsx("p", { className: "text-sm font-semibold", style: { color: 'var(--text-primary)' }, children: new Date(item.startDate).toLocaleDateString() })] })), item.targetDate && (_jsxs("div", { children: [_jsx("span", { className: "text-xs font-medium", style: { color: 'var(--text-muted)' }, children: "Target Date" }), _jsx("p", { className: `text-sm font-semibold ${new Date(item.targetDate) < new Date() && item.status !== 'completed'
                                                    ? 'text-red-600'
                                                    : ''}`, style: new Date(item.targetDate) >= new Date() || item.status === 'completed' ? { color: 'var(--text-primary)' } : {}, children: new Date(item.targetDate).toLocaleDateString() })] })), item.resolution && (_jsxs("div", { children: [_jsx("span", { className: "text-xs font-medium", style: { color: 'var(--text-muted)' }, children: "Resolution" }), _jsx("p", { className: "text-sm font-semibold capitalize", style: { color: 'var(--text-primary)' }, children: item.resolution.replace('_', ' ') })] })), item.closedAt && (_jsxs("div", { children: [_jsx("span", { className: "text-xs font-medium", style: { color: 'var(--text-muted)' }, children: "Closed" }), _jsx("p", { className: "text-sm font-semibold", style: { color: 'var(--text-primary)' }, children: new Date(item.closedAt).toLocaleDateString() })] }))] }), item.resolutionNote && (_jsxs("div", { className: "mt-2 p-3 rounded-lg", style: { backgroundColor: 'var(--bg-tertiary)' }, children: [_jsx("span", { className: "text-xs font-medium", style: { color: 'var(--text-muted)' }, children: "Resolution Note" }), _jsx("p", { className: "text-sm mt-1", style: { color: 'var(--text-primary)' }, children: item.resolutionNote })] }))] })), itemType === 'feature' && item.acceptanceCriteria && (_jsxs("div", { className: "px-6 pb-4", children: [_jsxs("h3", { className: "text-sm font-semibold mb-3 flex items-center gap-2", style: { color: 'var(--text-secondary)' }, children: [_jsx("span", { className: "material-symbols-outlined text-[18px]", children: "checklist" }), "Acceptance Criteria"] }), _jsx("div", { className: "p-4 rounded-lg", style: { backgroundColor: 'var(--bg-tertiary)' }, children: _jsx("p", { className: "text-sm whitespace-pre-wrap", style: { color: 'var(--text-primary)' }, children: item.acceptanceCriteria }) })] })), itemType === 'task' && (item.estimate || item.actualTime || item.dueDate || item.resolution) && (_jsxs("div", { className: "px-6 pb-4", children: [_jsxs("h3", { className: "text-sm font-semibold mb-3 flex items-center gap-2", style: { color: 'var(--text-secondary)' }, children: [_jsx("span", { className: "material-symbols-outlined text-[18px]", children: "info" }), "Details"] }), _jsxs("div", { className: "grid grid-cols-2 gap-4 p-4 rounded-lg", style: { backgroundColor: 'var(--bg-tertiary)' }, children: [item.estimate && (_jsxs("div", { children: [_jsx("span", { className: "text-xs font-medium", style: { color: 'var(--text-muted)' }, children: "Estimate" }), _jsxs("p", { className: "text-sm font-semibold", style: { color: 'var(--text-primary)' }, children: [item.estimate, "h"] })] })), item.actualTime && (_jsxs("div", { children: [_jsx("span", { className: "text-xs font-medium", style: { color: 'var(--text-muted)' }, children: "Actual Time" }), _jsxs("p", { className: "text-sm font-semibold", style: { color: 'var(--text-primary)' }, children: [item.actualTime, "h"] })] })), item.dueDate && (_jsxs("div", { children: [_jsx("span", { className: "text-xs font-medium", style: { color: 'var(--text-muted)' }, children: "Due Date" }), _jsx("p", { className: "text-sm font-semibold", style: { color: 'var(--text-primary)' }, children: new Date(item.dueDate).toLocaleDateString() })] })), item.resolution && (_jsxs("div", { children: [_jsx("span", { className: "text-xs font-medium", style: { color: 'var(--text-muted)' }, children: "Resolution" }), _jsx("p", { className: "text-sm font-semibold capitalize", style: { color: 'var(--text-primary)' }, children: item.resolution.replace('_', ' ') })] }))] }), item.resolutionNote && (_jsxs("div", { className: "mt-2 p-3 rounded-lg", style: { backgroundColor: 'var(--bg-tertiary)' }, children: [_jsx("span", { className: "text-xs font-medium", style: { color: 'var(--text-muted)' }, children: "Resolution Note" }), _jsx("p", { className: "text-sm mt-1", style: { color: 'var(--text-primary)' }, children: item.resolutionNote })] }))] })), item.metadata && Object.keys(item.metadata).length > 0 && (_jsxs("div", { className: "px-6 pb-4", children: [_jsxs("h3", { className: "text-sm font-semibold mb-3 flex items-center gap-2", style: { color: 'var(--text-secondary)' }, children: [_jsx("span", { className: "material-symbols-outlined text-[18px]", children: "code" }), "Metadata"] }), _jsxs("div", { className: "grid grid-cols-2 sm:grid-cols-3 gap-3", children: [item.metadata.linesAdded !== undefined && (_jsxs("div", { className: "p-3 rounded-lg bg-green-50 border border-green-200", children: [_jsx("span", { className: "text-xs font-medium text-green-600", children: "Lines Added" }), _jsxs("p", { className: "text-lg font-bold text-green-700", children: ["+", item.metadata.linesAdded] })] })), item.metadata.linesDeleted !== undefined && (_jsxs("div", { className: "p-3 rounded-lg bg-red-50 border border-red-200", children: [_jsx("span", { className: "text-xs font-medium text-red-600", children: "Lines Deleted" }), _jsxs("p", { className: "text-lg font-bold text-red-700", children: ["-", item.metadata.linesDeleted] })] })), item.metadata.filesChanged !== undefined && (_jsxs("div", { className: "p-3 rounded-lg bg-blue-50 border border-blue-200", children: [_jsx("span", { className: "text-xs font-medium text-blue-600", children: "Files Changed" }), _jsx("p", { className: "text-lg font-bold text-blue-700", children: item.metadata.filesChanged })] })), item.metadata.sourceTicketId && (_jsxs("div", { className: "p-3 rounded-lg", style: { backgroundColor: 'var(--bg-tertiary)' }, children: [_jsx("span", { className: "text-xs font-medium", style: { color: 'var(--text-muted)' }, children: "Source Ticket" }), _jsxs("p", { className: "text-sm font-semibold", style: { color: 'var(--text-primary)' }, children: ["#", item.metadata.sourceTicketId] })] }))] })] })), _jsxs("div", { className: "px-6 py-4 border-t flex items-center justify-between", style: { borderColor: 'var(--border-primary)', backgroundColor: 'var(--bg-tertiary)' }, children: [_jsx("div", { className: "text-xs", style: { color: 'var(--text-muted)' }, children: item.createdAt && (_jsxs("span", { children: ["Created: ", new Date(item.createdAt).toLocaleDateString()] })) }), _jsx("button", { onClick: onClose, className: "px-4 py-2 bg-primary hover:bg-blue-600 text-white rounded-lg text-sm font-semibold transition-colors", children: "Close" })] })] }) }) }));
}
